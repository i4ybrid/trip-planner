# Dockerfile.test - Testing
FROM node:20-alpine

WORKDIR /app

# Install dependencies
COPY package*.json ./
RUN npm ci --legacy-peer-deps

# Install Playwright browsers
RUN npm install -D @playwright/test && npx playwright install --with-deps chromium

# Generate Prisma client
RUN npx prisma generate

# Copy test configuration
COPY vitest.config.ts vitest.config.* ./
COPY playwright.config.ts ./

# Default command runs tests
CMD ["sh", "-c", "npm run test:all"]
